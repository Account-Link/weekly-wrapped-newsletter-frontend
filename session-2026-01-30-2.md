# 本次对话核心上下文

## 重构目标
- 将邮件生成主流程收敛到 ReportPipeline，API/预览入口统一调用
- 资源加载与上传拆分为独立模块，供 Satori 渲染复用
- 保持对外输出不变，减少重复逻辑

## 关键改动
- 新增核心模块
  - src/core/pipeline/report-pipeline.tsx：主流程编排与资源注入
  - src/core/assets/image-loader.ts：字体/图片读取与远程拉取
  - src/core/assets/satori-renderers.tsx：Satori 渲染器复用 image-loader
  - src/core/uploader/index.ts：统一上传入口
- 旧入口改为调用 Pipeline
  - app/api/wrapped/route.tsx
  - app/satori-preview/page.tsx
  - src/lib/email-generator.tsx（保留原导出）
- src/lib/satori-assets.tsx 改为转发至新模块

## 验证结果
- npm run lint：通过（仅旧有告警）
- npm run typecheck：通过
